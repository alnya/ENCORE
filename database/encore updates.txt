CREATE OR REPLACE FORCE VIEW "VWFIELDGROUPFIELD" ("ID", "FIELDGROUPID", "NAME", UNIQUE ("NAME") RELY DISABLE, CONSTRAINT "PK_VWFIELDGROUPFIELD" PRIMARY KEY ("ID") RELY DISABLE)
AS
  SELECT f.ID,
    fgf.FIELDGROUPID,
    (f.NAME ||' ('||f.unitname||')') as NAME
  FROM fieldgroupfield fgf
  INNER JOIN VWFIELDUNIT f
  ON fgf.FIELDID = f.ID;
  
CREATE OR REPLACE FORCE VIEW "VWREPORTFIELD" ("ID", "REPORTID", "FIELDORDER", "NAME", UNIQUE ("NAME") RELY DISABLE, CONSTRAINT "PK_VWREPORTFIELD" PRIMARY KEY ("ID") RELY DISABLE)
  AS
    SELECT f.ID,
      rf.REPORTID,
      rf.FIELDORDER,
      (f.NAME ||' ('||f.unitname||')') as NAME
    FROM REPORTFIELD rf
    INNER JOIN VWFIELDUNIT f
  ON rf.FIELDID = f.ID;
  
CREATE INDEX projectsitesummary_idx on PROJECTSITESUMMARY (PROJECTID,SITEID,FIELDID);

CREATE OR REPLACE FORCE VIEW "VWREPORTSITEFIELDSUMMARY" ("ID", "SITEID", "FIELDID", "ROWCOUNT", "VALUEMAXDATE", "VALUEMINDATE", CONSTRAINT "PK_VWREPORTSITEFIELDSUMMARY" PRIMARY KEY ("ID") RELY DISABLE)
AS
  SELECT pss.ID,
    ps.siteid,
    pf.fieldid,
    pss.RowCount,
    pss.valuemaxdate,
    pss.valuemindate
  FROM PROJECTSITESUMMARY pss
  RIGHT OUTER JOIN PROJECTSITE ps
  ON pss.SITEID = ps.sourceid
  RIGHT OUTER JOIN PROJECTFIELD pf
  ON pss.FIELDID = pf.sourceid;